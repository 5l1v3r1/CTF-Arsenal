#!/usr/bin/env python 

'''
We god hardcoded passphrase here in the 'index-source.html' 
>>import base64
>>decoded = '3d3d516343746d4d6d6c315669563362'.decode('hex')
>>unreversed = decoded[::-1]
>>base64.b64decode(unreversed)
'''

import requests 
import re
import base64 

r = requests.session()
url      = "http://natas8.natas.labs.overthewire.org/"
username = "natas8"
password = "DBfUBfqQG69KvJvJ1iAbMoIpwSNQ9bWe"
hexed_pass = "3d3d516343746d4d6d6c315669563362"
decoded = hexed_pass.decode('hex')
unreversed = decoded[::-1]
passphrase = base64.b64decode(unreversed)
data = {'secret' : passphrase , 'submit' : 'Submit+Query'}
resp = r.post(url,data = data,auth = (username,password))
flag = re.findall("is.*",resp.text)
flag = flag[1][2:].strip()
print("The key is : " + flag)